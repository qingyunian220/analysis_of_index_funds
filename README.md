# 优化的基金排名脚本

## 概述
该脚本用于获取并分析C份额基金的收益率，筛选出符合特定条件的基金，并将结果保存为Excel文件。它使用了 `akshare` 库来获取基金数据，并对数据进行处理和可视化。

## 功能
- 获取所有基金的基础信息。
- 筛选出C份额基金。
- 排除名称中包含特定关键词的基金（如“红利”、“基本面”、“价值”等）。
- 查询每只基金的成立时间和最新规模。
- 对各个时间段的收益率进行排名，并标注前10名。
- 对至少有4个时间段进入前10的基金，其基金简称标为金黄色。
- 将结果保存为Excel文件，并自适应列宽。

## 依赖
- `pandas`
- `akshare`
- `openpyxl`
- `tqdm`

## 使用方法
1. 确保已安装所需的库：
   ```bash
   pip install pandas akshare openpyxl tqdm
   ```

2. 运行脚本：
   ```bash
   python optimized_fund_ranking.py
   ```

3. 结果将保存为 `所有基金C份额收益率排名.xlsx` 文件。

## 代码结构
- **fetch_fund_data(fund_name)**: 根据基金名称获取C份额基金的数据，并查询成立时间和最新规模。
- **highlight_top_50_all_columns(df)**: 对每个收益率列标记前10名，并对至少有4列进入前10的基金标注基金简称为金黄色。
- **save_to_excel(writer, fund_df, sheet_name)**: 将处理后的基金数据保存到Excel文件中。

## 注意事项
- 由于 `akshare` 接口的访问频率限制，建议在使用时适当控制请求频率。
- 运行时可能会遇到网络问题或数据更新问题，请根据实际情况进行调试。

## 许可证
本项目采用 MIT 许可证，详细信息请查看 LICENSE 文件。
